{% extends "admin/base.html" %}

{% block title %}Customer Details - Cellar Society{% endblock %}

{% block content %}
<div class="page-header">
    <h2>Customer Details</h2>
    <p>Viewing profile and order history for: <strong style="color: var(--accent);">{{ customer.name }}</strong></p>
</div>

<div style="display: grid; grid-template-columns: 1fr 2fr; gap: 24px;">
    <!-- Customer Information -->
    <div class="card">
        <h3>Customer Information</h3>
        <div style="margin-top: 20px;">
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Customer ID</p>
                <p style="font-weight: 600; color: var(--primary);">#{{ customer.id }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Full Name</p>
                <p style="font-weight: 600;">{{ customer.name }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Email Address</p>
                <p style="font-weight: 600;">{{ customer.email }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Phone Number</p>
                <p style="font-weight: 600;">{{ customer.phone if customer.phone else 'Not provided' }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Shipping Address</p>
                <p style="font-weight: 600;">{{ customer.address if customer.address else 'Not provided' }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Member Since</p>
                <p style="font-weight: 600;">{{ customer.joined_at[:10] }}</p>
            </div>
            
            <div style="margin-bottom: 16px;">
                <p style="color: var(--muted); font-size: 13px; margin-bottom: 4px;">Total Orders</p>
                <p style="font-weight: 600; color: var(--accent); font-size: 1.5em;">{{ orders|length }}</p>
            </div>
        </div>
        
        <a href="{{ url_for('customers') }}" class="btn ghost" style="margin-top: 20px; width: 100%;">← Back to Customers</a>
    </div>
    
    <!-- Order History -->
    <div class="card">
        <h3>Order History ({{ orders|length }} orders)</h3>
        
        {% if orders %}
        <div class="table-container" style="margin-top: 20px;">
            <table>
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Product</th>
                        <th>Type</th>
                        <th>Quantity</th>
                        <th>Total Price</th>
                        <th>Status</th>
                        <th>Order Date</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in orders %}
                    <tr>
                        <td><strong>#{{ order.id }}</strong></td>
                        <td>{{ order.product_name }}</td>
                        <td><span class="badge primary">{{ order.product_type }}</span></td>
                        <td>{{ order.quantity }}</td>
                        <td><strong>₱{{ "%.2f"|format(order.total_price) }}</strong></td>
                        <td>
                            {% if order.status == 'Pending' %}
                                <span class="badge warning">{{ order.status }}</span>
                            {% elif order.status == 'Processing' %}
                                <span class="badge primary">{{ order.status }}</span>
                            {% elif order.status == 'Delivered' %}
                                <span class="badge success">{{ order.status }}</span>
                            {% elif order.status == 'Received' %}
                                <span class="badge success">{{ order.status }}</span>
                            {% else %}
                                <span class="badge">{{ order.status }}</span>
                            {% endif %}
                        </td>
                        <td>{{ order.order_date[:10] }}</td>
                        <td>
                            <a href="{{ url_for('order_detail', order_id=order.id) }}" class="btn btn-small ghost">View</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <h3>No Orders Yet</h3>
            <p>This customer hasn't placed any orders.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}